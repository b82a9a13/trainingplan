document.getElementById("plan_form").addEventListener("submit",e=>{e.preventDefault();const t=["name","employer","startdate","planenddate","lengthofprog","otjh","epao","fundsource","bksbrm","bksbre","learnstyle","skillscanlr","skillscaner","apprenhpw","weeksonprog","annualleave","hoursperweek","aostrength","ltgoals","stgoals","iaguide","mathfs","mathlevel","mathmod","mathsd","mathped","engfs","englevel","engmod","engsd","engped","recopl","addsa"],n=[["mod-m","mod-psd","mod-ped","mod-mw","mod-potjh","mod-mod","mod-otjt"],["pr-type","pr-pr"]],o=document.getElementById("tp_error");o.style.display="none";let l="";t.forEach(function(e){l+=`${e}=${document.getElementById(e).value.replaceAll("&","($)")}&`,document.getElementById("td_"+e).style.background=""});let d=0;n[0].forEach(function(e){const t=document.querySelectorAll("."+e),n=document.querySelectorAll(".td-"+e);for(let o=0;o<t.length;o++)l+=`${e}-${o}=${t[o].value.replaceAll("&","($)")}&`,n[o].style.background="";d=d<t.length?t.length:d}),l+=`mod-total=${d}&`,d=0,n[1].forEach(function(e){const t=document.querySelectorAll("."+e),n=document.querySelectorAll(".td-"+e);for(let o=0;o<t.length;o++)l+=`${e}-${o}=${t[o].value}&`,n[o].style.background="";d=d<t.length?t.length:d}),l+=`fscheckbox=${document.getElementById("fscheckbox").checked}&pr-total=${d}`;const c=new XMLHttpRequest;c.open("POST","./classes/inc/newplan.inc.php",!0),c.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),c.onload=function(){if(200==this.status){const e=JSON.parse(this.responseText);e.error?(o.innerText="Invalid values: ",e.error.forEach(function(e){t.includes(e[0])?document.getElementById("td_"+e[0]).style.background="red":n[0].includes(e[0])?document.querySelectorAll(".td-"+e[0])[e[2]].style.background="red":n[1].includes(e[0])&&(document.querySelectorAll(".td-"+e[0])[e[2]].style.background="red"),o.innerText+=e[1]+"|"}),o.style.display="block"):e.return?window.location.reload():(o.innerText="Creation error.",o.style.display="block")}else o.innerText="Connection error.",o.style.display="block"},c.send(l)});const checkbox=document.getElementById("fscheckbox");checkbox.addEventListener("change",()=>{const e=["mathfs","mathlevel","mathmod","mathsd","mathped","engfs","englevel","engmod","engsd","engped"];checkbox.checked?(e.forEach(function(e){document.getElementById(e).required=!0}),document.getElementById("fs_div").style.display="block"):(e.forEach(function(e){document.getElementById(e).required=!1}),document.getElementById("fs_div").style.display="none")});