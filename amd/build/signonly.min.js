document.getElementById("sign_form").addEventListener("submit",e=>{e.preventDefault();const t=document.getElementById("sign_error");t.style.display="none",t.innerHTML="";const n=document.getElementById("signature");let r=n.getContext("2d").getImageData(0,0,n.width,n.height).data,s="Invalid Signature.";for(let e=0;e<r.length;e+=12){const t=r[e],n=r[e+1],i=r[e+2];255===t&&255===n&&255===i||(s="")}if(""!=s)t.innerText=s,t.style.display="block";else{const e=n.toDataURL("image/jpeg"),r=`sign=${e}`,s=new XMLHttpRequest;s.open("POST","./classes/inc/sign.inc.php",!0),s.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),s.onload=function(){if(200==this.status){const e=JSON.parse(this.responseText);if(console.log(e),e.error){if(e.error.length>0){let n=0;t.innerText="Invalid: ";for(const r of e.error)0==n?(t.innerText+=r,n++):t.innerText+=", "+r;t.innerText+="."}else t.innerText=e.error[0];t.style.display="block"}else e.return?document.getElementById("sign_btm").click():(t.innerText="Creation error.",t.style.display="block")}else t.innerText="Creation error.",t.style.display="block"},s.send(r)}});